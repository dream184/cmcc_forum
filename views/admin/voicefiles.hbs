<section class="voicefiles-section col-12 col-md-9">
  <div class="voicefiles-container">
    {{>message}}
    <div class="homeworks-title d-flex justify-content-between my-3">
      <h3 class="class-name">瀏覽所有學員音檔</h3>
      <div class="btn-group">
        <button type="button" class="btn btn-sm btn-secondary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          選擇排序
        </button>
        <div class="dropdown-menu dropdown-menu-right">
          <a href="/admin/voicefiles/date-asc" class="dropdown-item"> 依日期：從舊到新</a>
          <a href="/admin/voicefiles/date-desc" class="dropdown-item">依日期：從新到舊</a>
          <a href="/admin/voicefiles/classes" class="dropdown-item">依班級</a>
          <a href="/admin/voicefiles/homeworks" class="dropdown-item">依作業排序</a>
          <a href="/admin/voicefiles/authors" class="dropdown-item">依發布人排序</a>
        </div>
      </div>
    </div>

    <table class="voicefiles-table bg-white w-100">
      <thead class="thead-dark bg-info bg-gradient w-100">
        <tr class="w-100 text-white">
          <th scope="col" class="col-2 p-1">作業</th>
          <th scope="col" class="col-2 p-1">日期</th>
          <th scope="col" class="col-2 p-1">群組</th>
          <th scope="col" class="col-2 p-1">發布人</th>
          <th scope="col" class="col-2 p-1">查看評論</th>
          <th scope="col" class="col-2 p-1">點評</th>
        </tr>
      </thead>
    
      <tbody>
        {{#each voicefiles}}
        <tr>
          <th scope="row" class="p-1">
            {{this.Homework.name}}
          </th>

          <td class="p-1">
            {{dayjs this.createdAt}}
          </td>
    
          <td class="p-1">
            {{this.Class.name}}
          </td>

          <td class="p-1">
            {{this.User.name}}
          </td>

          <td class="p-1">
            <a href="/admin/voicefiles/{{this.id}}/feedbacks" class="btn btn-success">查看</a>
          </td>

          <td class="p-1">

            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#mentorFeedbackVoicefile{{this.id}}">
              點評
            </button>
            
            <!-- Modal -->
            <div class="modal fade" id="mentorFeedbackVoicefile{{this.id}}" data-backdrop="static" data-keyboard="false" tabindex="-1"
              aria-labelledby="mentorFeedbackLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="mentorFeedbackLabel">{{this.Homework.name}} {{this.User.name}}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="col-12">
                      <div class="container-audio d-flex justify-content-center">
                        <audio controls preload="none">
                          <source src="https://docs.google.com/uc?export=open&id={{this.googleFileId}}" type="audio/mp4">
                          <source src="https://docs.google.com/uc?export=open&id={{this.googleFileId}}"
                            type="audio/mpeg">
                          <source src="https://docs.google.com/uc?export=open&id={{this.googleFileId}}"
                            type="audio/ogg">
                          您的瀏覽器不支援 audio tag，請點選下面網址收聽音檔
                          <a href="https://docs.google.com/uc?export=open&id={{this.googleFileId}}">音檔連結</a>
                        </audio>
                      </div>
                    </div>
                    
                    <div class="form-group">
                      <form action="/admin/voicefiles/{{this.id}}/feedbacks" method="POST">
                        <label for="feedbackTextarea" class="d-block font-weight-bold">點評回饋</label>
                        <div class="form-check form-check-inline">
                          星星數
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="ranking" id="one-star" value="1">
                          <label class="form-check-label" for="one-star">1</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="ranking" id="two-star" value="2">
                          <label class="form-check-label" for="two-star">2</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="ranking" id="three-star" value="3">
                          <label class="form-check-label" for="three-star">3</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="ranking" id="four-star" value="4">
                          <label class="form-check-label" for="four-star">4</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="ranking" id="five-star" value="5">
                          <label class="form-check-label" for="five-star">5 (顆星)</label>
                        </div>
                        <textarea class="form-control mt-2" id="feedbackTextarea" rows="3" name="feedback"></textarea>
                        <div class="modal-footer border-0">
                          <button type="button" class="btn btn-secondary" data-dismiss="modal">關閉</button>
                          <button type="submit" class="btn btn-primary">送出</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
        {{/each}}
      </tbody>
    </table>
    {{#unless voicefiles}}
    <div class="alert alert-info my-2" role="alert">
      現在沒有任何上傳音檔
    </div>
    {{/unless}}
  </div>
  <div class="paginator-container">
    <nav aria-label="Page navigation example" class="mx-auto my-2">
      <ul class="pagination d-flex justify-content-center">
        <li class="page-item">
          <a class="page-link" href="/admin/voicefiles?page={{prev}}&order={{order}}" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        {{#each totalPage}}
        {{#if (equal this ../page)}}
        <li class="page-item active"><a class="page-link" href="#">{{this}}</a></li>
        {{else}}
        <li class="page-item"><a class="page-link" href="/admin/voicefiles?page={{this}}&order={{../order}}">{{this}}</a>
        </li>
        {{/if}}
        {{/each}}
        <li class="page-item"><a class="page-link" href="/admin/voicefiles?page={{next}}&order={{order}}"
            aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</section>
  